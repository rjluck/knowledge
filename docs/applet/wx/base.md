# 初识

[[toc]]

## 小程序与普通网页开发的区别
（1）运行环境不同
网页运行在浏览器环境中
小程序运行在微信环境中

（2）开发模式不同
网页的开发模式：浏览器+代码编辑器
小程序有自己的一套标准开发模式：
- 申请小程序开发账号
- 安装小程序开发者工具
- 创建和配置小程序项目

（3）API不同
由于运行环境的不同，所以小程序中，无法调用DOM和BOM的API。但是，小程序中可以调用微信环境提供的各种API，例如
- 地理定位
- 扫码
- 支付



## 注册小程序开发账号

浏览器打开 https://mp.weixin.qq.com

获取小程序的AppID途径
- 登录小程序管理后台
- 开发设置即可获取

![image](/imgs/applet/wx/wx1.png)

> 创建项目的时候需要用到AppID



## 了解微信开发者工具
是官方推荐使用的小程序开发工具，它提供的主要功能如下：
- 快速创建小程序项目
- 代码的查看和编辑
- 对小程序功能进行调试
- 小程序的预览和发布


- 下载：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
- 安装
- 扫码登录

### 设置外观和代理
![image](/imgs/applet/wx/wx2.png)



### 创建小程序项目

![image](/imgs/applet/wx/wx3.png)



### 查看项目效果

#### 在模拟器上查看项目效果
![image](/imgs/applet/wx/wx4.png)

#### 在真机上预览项目效果
![image](/imgs/applet/wx/wx5.png)


### 主界面的5个组成部分
![image](/imgs/applet/wx/wx6.png)





## 小程序代码的构成

### 项目结构

#### 基本组成结构

- **`pages`用来存放所有小程序的页面**
- `utils`用来存放工具性质的模块（例如：格式化时间的自定义模块）
- **`app.js`小程序项目的入口文件**
- **`app.json`小程序项目的全局配置文件**
- `app.wxss`小程序项目的全局样式文件
- `project.config.json`项目的配置文件
- `sitemap.json`用来配置小程序及页面是否允许被微信索引


#### 页面的组成部分

小程序官方建议把所有小程序的页面，都存放在`pages`目录中，以单独的文件夹存在，如图所示：
![image](/imgs/applet/wx/wx7.png)

其中每个页面由4个基本文件组成，他们分别是：
- `.js`文件（页面的脚本文件，存放页面的数据、事件处理函数等）
- `.json`文件（当前页面的配置文件，配置窗口的外观、表现等）
- `.wxml`文件（页面的模板结构文件）
- `.wxss`文件（当前页面的样式表文件）


### JSON配置文件


**JSON是一种数据格式**，在实际开发中，`JSON`总是以**配置文件**的形式出现。小程序项目中也不例外：通过不同的`.json`配置文件，可以对小程序项目进行不同级别的配置。


小程序项目中有4种json配置文件，分别是：
- 项目根目录中的`app.json`配置文件
- 项目根目录中的`project.config.json`配置文件
- 项目根目录中的`sistmap.json`配置文件
- 每个页面文件夹中的`.json`配置文件


#### app.json文件

`app.json`是当前小程序的**全局配置**，包括了小程序的所有页面路径、窗口外观、界面表现、底部tab等。

Demo项目里边的`app.json`配置内容如下：
![image](/imgs/applet/wx/wx8.png)


配置项的作用：
- `pages`：用来记录当前小程序所有页面的路径
- `window`：全局定义小程序所有页面的背景色、文字颜色等
- `style`:全局定义小程序组件所使用的样式版本
- `sitemapLocation`:用来指明`sitemap.json`的位置


#### project.config.json文件

`project.config.json`是项目配置文件，用来记录我们对小程序开发工具所做的个性化配置，例如：

- `setting`中保存了编译相关的配置
- `projectname`中保存的是项目名称
- `appid`中保存的是小程序的账号ID



#### sitemap.json

微信现已开放小程序搜索，效果类似于PC网页的SEO。`sitemap.json`文件用来配置小程序页面是否允许微信索引。


当开发者允许微信索引时，微信会通过爬虫的形式，为小程序的页面建立索引。当用户的搜素关键字和页面的索引匹配成功的时候，小程序的页面将可能展示在搜素结果中。

- `page`属性的`*`表示所有页面
- `action`：
  - `allow`:允许索引页面
  - `disallow`：不允许被索引
![image](/imgs/applet/wx/wx9.png)

> 注意：`sitemap`的索引提示是默认开启的，如需要关闭`sitemap`的索引提示，可在小程序项目配置文件`project.config.json`的`setting`中配置字段`checkSiteMap`为`false`


#### 页面的`.json`配置文件

小程序中的每一个页面，可以使用`.json`文件来对本页面的窗口外观进行配置，页面中的配置项会覆盖`app.json`的`window`中相同的配置项。例如：
![image](/imgs/applet/wx/wx10.png)












## 小程序页面操作


### 新建小程序页面

只需要在`app.json`->`pages`中新增页面的存放路径，小程序开发者工具即可帮我们自动创建对应的页面文件，如图所示：
![image](/imgs/applet/wx/wx11.png)


### 修改项目首页

只需要调整`app.json`->`pages`数组中野蛮路径的前后顺序，即可修改项目的首页。小程序会把排在第一位的页面，当做项目首页进行渲染，如图所示：
![image](/imgs/applet/wx/wx12.png)


## WXML模板

### 什么是WXML

WXML（WeiXin Markup Language）是小程序框架设计的一套标签语言，用来构建小程序页面的结构，其作用类似于网页开发中的HTML。

### WXML和HTML的区别

- 标签名称不同
  - HTML（div，span，img，a）
  - WXML（view，text，image，navigator）
- 属性节点不同
  - `<a href="#">超链接</a>`
  - `<navigator url="/pages/home/home"></navigator>`
- 提供了类似于`Vue`中的模板语法
  - 数据绑定
  - 列表渲染
  - 条件渲染



## WXSS样式

### 什么是WXSS

WXSS（WeiXin Style Sheets）是一套样式语言，用于描述`WXML`的组件样式，类似于网页开发中的`CSS`。

### WXSS和CSS的区别
- 新增了`rpx`尺寸单位
  - `CSS`中需要手动进行像素单位换算，例如`rem`
  - `WXSS`在底层支持新的尺寸单位`rpx`,在不同大小的屏幕上小程序会自动进行换算
- 提供了全局的样式和局部样式
  - 项目根目录中的`app.wxss`会作用于所有小程序页面
  - 局部页面的`.wxss`样式仅对当前页面生效
- `WXSS`仅支持部分`CSS`选择器
  - `.class`和`#id`
  - `element`
  - 并集选择器、后代选择器
  - `::after`和`::before`等伪类选择器



## JS逻辑交互

### 小程序中的.js文件

一个项目仅仅提供界面展示是不够的，在小程序中，我们通过`.js`文件来处理用户的操作。例如：响应用户的点击、获取用户的位置等等。

### 小程序中的.js文件分类

小程序中的JS文件分为三大类：分别是：
- `app.js`
  - 是整个小程序项目的入口文件，通过调用`App()`函数来启动整个小程序
- 页面的`.js`文件
  - 是页面的入口文件，通过调用`Page()`函数来创建并运行页面
- 普通的`.js`文件
  - 是普通的功能模块文件，用来封装**公共的函数或属性**供页面使用



## 宿主环境简介

### 什么是宿主环境

宿主环境（host environment）指的是**程序运行所必须的依赖环境**。例如：

`Android系统`和`iOS系统`是两个不同的宿主环境。安卓版的微信`App`是不能在`iOS`环境下运行的，所以，`Android`是安卓软件的宿主环境，**脱离了宿主环境的软件是没有任何意义的**！

![image](/imgs/applet/wx/wx13.png)


### 小程序的宿主环境

手机微信是小程序的宿主环境，如图所示：
![image](/imgs/applet/wx/wx14.png)

> 小程序借助宿主环境提供的能力，可以完成许多普通网页无法完成的功能，例如：微信扫码、微信支付、微信登录、地理定位、etc...


小程序的宿主环境包含的内容
- 通信模型
- 运行机制
- 组件
- API

#### 通信模型

**1.通信的主体**
小程序中通信的主体是**渲染层**和**逻辑层**，其中：
- `WXML`模板和`WXSS`样式工作在渲染层
- `JS`脚本工作在逻辑层
![image](/imgs/applet/wx/wx15.png)


**2.小程序的通信模型**

小程序中的通信模型分为两部分：
- **渲染层**和**逻辑层**之间的通信（由微信客户端进行转发）
- **逻辑层**和**第三方服务器**之间的通信（由微信客户端进行转发）

![image](/imgs/applet/wx/wx16.png)


#### 运行机制

**1.小程序启动的过程**
- 把小程序的代码包下载到本地
- 解析`app.json`全局配置文件
- 执行`app.js`小程序入口文件，调用`App()`创建小程序实例
- 渲染小程序首页
- 小程序启动完成


**2.页面渲染的过程**
- 加载解析页面的`.json`配置文件
- 加载页面的`.wxml`模板和`.wxss`样式
- 执行页面的`.js`文件，调用`Page()`创建页面实例
- 页面渲染完成





## 协同工作

### 了解权限管理需求

在中大型的公司里，人员的分工非常仔细：同一个小程序项目，一般会有不同岗位、不同角色的员工同时参与设计与开发。

此时出于管理需要，我们迫切需要对不同岗位、不同角色的员工的权限进行边界的划分，使他们能够高效的进行协同工作。


### 了解项目成员的组织结构
![image](/imgs/applet/wx/wx26.png)


### 小程序的开发流程
![image](/imgs/applet/wx/wx27.png)


### 小程序成员管理
![image](/imgs/applet/wx/wx28.png)


### 不同项目成员对应的权限
![image](/imgs/applet/wx/wx29.png)


开发者的权限说明：
- 开发者权限：可使用小程序开发者工具及对小程序的功能进行代码开发
- 体验者权限：可使用体验版小程序
- 登录权限：可登录小程序管理后台，无需管理员确认
- 开发设置：设置小程序服务器域名、消息推送及扫描普通链接二维码打开小程序
- 腾讯云管理：云开发相关设置


### 添加项目成员和体验成员
![image](/imgs/applet/wx/wx30.png)



### 小程序的版本
在软件开发过程，根据时间节点的不同，会产出不同的软件版本，例如：
- 开发者编写代码的同时，对项目代码进行自测（开发版本）
- 直到程序达到一个稳定可体验的状态时，开发者把体验版本给到产品经理和测试人员进行体验测试
- 最后修复完程序的Bug后，发布正式版供外部用户使用


小程序的版本如下：
![image](/imgs/applet/wx/wx31.png)


## 发布上线整体步骤
一个小程序的发布上线，一般要经过`上传代码`->`提交审核`->`发布`这三个步骤。

### 上传代码
- 点击开发者工具顶部工具栏中的"上传"按钮
- 填写版本号以及项目备注

![image](/imgs/applet/wx/wx32.png)

> 在后台查看上传之后的版本
> 登录小程序管理后台->管理->版本管理->开发版本，即可查看刚才提交的版本了

![image](/imgs/applet/wx/wx33.png)



### 提交审核
- 为什么需要提交审核：为了保证小程序的质量，以及符合相关的规范，小程序的发布是需要经过腾讯官方审核的。
- 提交审核的方式：在开发版本的列表中，点击"提交审核"按钮之后，按照页面提示填写相关的信息，就能把小程序提交到腾讯官方进行审核。

![image](/imgs/applet/wx/wx34.png)


### 发布
审核通过之后，管理员的微信中会收到小程序通过审核的通知，此时在审核版本的列表中，点击"**发布**"按钮之后，即可把"**审核通过**"的版本发布为"**线上版本**"，供所有小程序用户访问和使用。

![image](/imgs/applet/wx/wx35.png)


### 推广

基于小程序码进行推广

相对于普通二维码来说，小程序码的优势如下：
- 在样式上具有**辨识度**和**视觉冲击力**
- 能够更加清晰地树立小程序的品牌形象
- 可以帮助开发者更好地推广小程序


获取小程序码的5个步骤：
> 登录小程序管理后台->设置->基本设置->基本信息->小程序码及线下物料下载




## 运营数据

查看小程序运营数据的两种方式

（1）在“小程序后台”查看
- 登录小程序管理后台
- 点击侧边栏的“统计”
- 点击相应的tab可以看到相关的数据
![image](/imgs/applet/wx/wx36.png)

（2）使用“小程序数据助手”查看
- 打开微信
- 搜素“小程序数据助手”
- 查看已发布的小程序相关的数据


## 自定义编译模式
![image](/imgs/applet/wx/wx108.png)